## ADDED Requirements

### Requirement: 包重装功能

应用 MUST 支持对已安装的软件包执行重新安装操作，以修复损坏的安装或刷新安装文件。

#### Scenario: 显示重新安装按钮

**Given** 用户在包管理界面
**And** 存在已安装的软件包版本
**When** 用户在版本下拉框中选择已安装的版本
**Then** 界面显示"重新安装"按钮
**And** 该按钮与"安装"按钮在视觉上有明确区分

#### Scenario: 重装确认对话框

**Given** 用户选择了已安装的版本
**And** 用户点击"重新安装"按钮
**When** 确认对话框显示
**Then** 对话框标题显示"确认重新安装"/"Confirm Reinstallation"
**And** 对话框内容包含要重装的版本号
**And** 对话框说明操作将删除缓存和已安装版本
**And** 提供"取消"和"重新安装"两个按钮

#### Scenario: 重装流程 - 清理阶段

**Given** 用户确认了重装操作
**When** 重装流程开始
**Then** 应用首先删除缓存中的旧软件包文件
**And** 显示进度："清理缓存中..."/"Clearing cache..."
**And** 然后删除已安装的版本目录
**And** 显示进度："删除旧版本..."/"Removing old version..."

#### Scenario: 重装流程 - 下载和安装阶段

**Given** 缓存和旧版本已清理完成
**When** 进入下载安装阶段
**Then** 应用从配置的包源重新下载软件包
**And** 显示下载进度
**And** 下载完成后解压包到安装目录
**And** 验证安装完整性
**And** 更新包元数据

#### Scenario: 重装成功反馈

**Given** 重装流程完成所有步骤
**When** 安装验证通过
**Then** 显示成功通知
**And** 通知内容："版本 X.X.X 重新安装成功"/"Version X.X.X reinstalled successfully"
**And** 自动刷新包信息和依赖状态
**And** 版本下拉框保持当前选中的版本

#### Scenario: 重装失败处理

**Given** 重装流程中发生错误
**When** 任何步骤失败（清理、下载、安装）
**Then** 显示错误通知
**And** 错误消息包含具体的失败阶段和原因
**And** 应用保持原有安装状态不变
**And** 用户可以重试重装操作

#### Scenario: 重装进度反馈

**Given** 用户正在执行重装操作
**When** 重装进行中
**Then** 界面显示当前执行阶段
**And** 各阶段显示对应的进度百分比
**And** 进度条实时更新
**And** 当前阶段描述文本清晰

#### Scenario: 取消重装操作

**Given** 用户点击了"重新安装"按钮
**And** 确认对话框已显示
**When** 用户点击"取消"按钮
**Then** 关闭确认对话框
**And** 不执行任何重装操作
**And** 已安装的版本保持不变

#### Scenario: 重装时的禁用状态

**Given** 用户正在执行重装操作
**When** 重装进行中
**Then** "重新安装"按钮处于禁用状态
**And** 版本下拉框不可更改
**And** 其他安装相关按钮（如"刷新"）被禁用
**And** 显示加载动画

---

### Requirement: 重装状态管理

应用 MUST 提供清晰的重装状态管理和进度反馈机制。

#### Scenario: 重装状态持久化

**Given** 用户开始重装操作
**When** 重装流程进行中
**Then** Redux 状态包含 `isReinstalling` 标志
**And** 该标志为 `true` 时表示正在重装
**And** 组件根据此标志禁用相关 UI 元素

#### Scenario: 重装进度跟踪

**Given** 重装流程进行中
**When** 各阶段执行
**Then** Redux 状态包含 `reinstallProgress` 对象
**And** 进度对象包含当前阶段（`stage`）
**And** 进度对象包含进度百分比（`progress`）
**And** 进度对象包含进度消息（`message`）
**And** UI 实时反映进度变化

#### Scenario: 重装完成状态清理

**Given** 重装操作完成（成功或失败）
**When** 最终结果确定
**Then** Redux 状态中 `isReinstalling` 设置为 `false`
**And** UI 恢复正常交互状态
**And** 用户可以执行其他操作

---

### Requirement: 重装错误恢复

应用 MUST 在重装失败时提供合理的错误恢复机制。

#### Scenario: 部分清理后失败

**Given** 重装过程中缓存已删除
**When** 后续步骤失败
**Then** 应用记录错误日志
**And** 不保留半完成的安装状态
**And** 用户可以重新尝试重装

#### Scenario: 网络错误重试

**Given** 重装时从远程源下载包
**When** 网络连接中断
**Then** 显示网络错误消息
**And** 提供"重试"选项
**And** 清理已下载的部分文件

#### Scenario: 磁盘空间不足

**Given** 重装流程开始前
**When** 检测到磁盘空间不足
**Then** 显示磁盘空间不足的错误消息
**And** 不启动重装流程
**And** 提示用户清理磁盘空间

---

### Requirement: 国际化支持

重装功能界面 MUST 支持中文和英文界面语言。

#### Scenario: 重装按钮的国际化

**Given** 用户使用不同语言
**When** 渲染包管理界面
**Then** 中文界面显示"重新安装"按钮
**And** 英文界面显示"Reinstall"按钮

#### Scenario: 重装确认对话框的国际化

**Given** 用户使用不同语言
**When** 显示重装确认对话框
**Then** 中文界面显示中文提示和按钮
**And** 英文界面显示英文提示和按钮
**And** 版本号格式在各语言下正确显示

#### Scenario: 重装进度的国际化

**Given** 用户使用不同语言
**When** 显示重装进度
**Then** 各阶段描述使用对应语言
**And** 进度百分比在各语言下显示一致

#### Scenario: 重装通知的国际化

**Given** 用户使用不同语言
**When** 显示重装结果通知
**Then** 成功通知使用对应语言
**And** 错误通知使用对应语言
**And** 版本号在各语言下正确显示
