# version-management Specification Delta

## ADDED Requirements

### Requirement: 安装按钮加载状态反馈

应用 MUST 在版本管理界面的安装按钮上提供即时的加载状态反馈，当用户点击安装按钮时显示加载指示器。

#### Scenario: 点击安装按钮后立即显示 loading 状态

**Given** 用户在版本管理界面
**And** 显示可用版本列表
**When** 用户点击某个版本的安装按钮
**Then** 安装按钮立即显示加载指示器（spinner）
**And** 按钮文本更改为"安装中..."或对应语言的翻译文本
**And** 按钮被禁用，防止用户重复点击
**And** 按钮样式显示为禁用状态（降低透明度）

#### Scenario: 安装完成时显示成功通知

**Given** 用户正在安装某个版本
**And** 安装按钮显示 loading 状态
**When** 安装流程成功完成
**Then** 显示成功 Toast 通知
**And** 通知标题为"安装成功"
**And** 通知描述为"版本已成功安装，请手动启动服务。"
**And** 安装按钮恢复正常状态（移除 loading 指示器）
**And** 版本列表刷新，显示该版本为"已安装"状态
**And** Toast 通知在 3 秒后自动关闭

#### Scenario: 安装失败时显示错误通知

**Given** 用户正在安装某个版本
**And** 安装按钮显示 loading 状态
**When** 安装流程失败（网络错误、文件损坏等）
**Then** 显示错误 Toast 通知
**And** 通知标题为"安装失败"
**And** 通知描述包含具体的失败原因
**And** 安装按钮恢复正常状态（移除 loading 指示器）
**And** 用户可以重新点击安装按钮进行重试

#### Scenario: 服务运行时显示安装确认对话框

**Given** Web 服务当前正在运行
**And** 用户点击安装按钮
**When** 安装操作被触发
**Then** 显示确认对话框
**And** 对话框标题为"确认安装"
**And** 对话框内容说明"安装需要停止当前运行的服务，是否继续？"
**And** 提供"取消"和"确认"按钮
**And** 安装按钮保持正常状态（不显示 loading）

#### Scenario: 用户取消安装确认后重置状态

**Given** 安装确认对话框正在显示
**When** 用户点击"取消"按钮
**Then** 关闭确认对话框
**And** 安装按钮恢复正常状态
**And** 不执行任何安装操作
**And** 服务继续运行

#### Scenario: 用户确认安装后停止服务并开始安装

**Given** 安装确认对话框正在显示
**When** 用户点击"确认"按钮
**Then** 关闭确认对话框
**And** 停止当前运行的 Web 服务
**And** 等待服务完全停止
**And** 安装按钮显示 loading 状态
**And** 开始安装流程

#### Scenario: 重新安装按钮显示 loading 状态

**Given** 用户在已安装版本列表
**And** 点击某个版本的"重新安装"按钮
**When** 重新安装操作被触发
**Then** 重新安装按钮显示加载指示器（spinner）
**And** 按钮文本更改为"重新安装中..."
**And** 按钮被禁用
**And** 其他操作按钮（查看依赖、打开日志、切换）保持可用

#### Scenario: 安装状态与其他异步操作保持一致

**Given** 应用中存在其他异步操作（依赖检查、服务启动）
**And** 这些操作已实现 loading 状态反馈
**When** 用户执行安装操作
**Then** 安装按钮的 loading 状态样式与其他操作保持一致
**And** 使用相同的 spinner 动画和颜色
**And** Toast 通知样式与依赖检查、服务启动的通知一致

#### Scenario: 国际化支持加载状态文本

**Given** 应用支持多种语言（中文、英文）
**When** 用户切换语言
**Then** 安装按钮的 loading 文本使用当前语言
**And** 中文界面显示"安装中..."
**And** 英文界面显示"Installing..."
**And** Toast 通知的标题和描述使用当前语言
